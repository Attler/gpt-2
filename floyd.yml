# see: https://docs.floydhub.com/floyd_config
# All supported configs:
#
#machine: cpu
#env: tensorflow-1.8
#input:
#  - destination: input
#    source: foo/datasets/yelp-food/1
#  - foo/datasets/yelp-food-test/1:test
#description: this is a test
#max_runtime: 3600
#command: python train.py

# You can also define multiple tasks to use with --task argument:
#
#task:
#  evaluate:
#    machine: gpu
#    command: python evaluate.py
#
#  serve:
#    machine: cpu
#    mode: serve

machine: gpu2
env: tensorflow-1.13
input:
  - destination: news
    source: jjatler/datasets/abridged-news/4
command: python download_model.py 345M && python train.py --dataset /floyd/input/news/input-text.txt.npz --save_every=250 --val_every=250 --sample_every=1000 --batch_size=2 --only_train_transformer_layers --learning_rate=0.000002 --model_name 345M


task:
  evaluate:
    input:
      - destination: old
        source: jjatler/projects/headlines/54
    command: python download_model.py 345M && python src/headline_eval.py --model_name 345M
    description: evaluate
